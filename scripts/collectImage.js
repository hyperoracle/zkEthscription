import base64ImageToFile from "base64image-to-file";

var eventDataBytes =
  "00bc614e646174613a696d6167652f6a7065673b6261736536342c2f396a2f34414151536b5a4a5267414241514141415141424141442f327745454541424441454d4151774244414563415177424c41464d415577424c414767416341426b41484141614143614149304167514342414930416d674470414b59417377436d414c4d41706744704157494133414543414e774133414543414e774259674534415873424e4145664154514265774534416a4942755147484159634275514979416f6b43495149454169454369514d534172384376774d534139344472415065425134464467624c4551424441454d4151774244414563415177424c41464d415577424c414767416341426b41484141614143614149304167514342414930416d674470414b59417377436d414c4d41706744704157494133414543414e774133414543414e774259674534415873424e4145664154514265774534416a4942755147484159634275514979416f6b43495149454169454369514d534172384376774d534139344472415065425134464467624c2f384941455167415441424d417745694141495241514d5241662f454143774141414d4241514141414141414141414141414141414141434177454541514542415141414141414141414141414141414141414141514c2f3267414d417745414168414445414141414f414141595575684d594641446373563649374c6b3654584d624c495a754964664c306e5643545339335045796a525452455a62446f353646567a5177463163425642414148514b45775a5141412f2f3851414a424142414149424241494341674d4141414141414141414151414345514d534954455151534169457a42525958482f3267414941514541415438412f625473347a4c61526d4f6e2f444e6a477166414d7a5955715a4a585336566d4531584d72516175586d4e583378784d4c6d574d506d6c556a7061746f4e2b737770626c6a6b7a676c796f55426e396534392b4355666f7831714a4d356638415a587161324a686a564d53353472325266714241446d3833747863645438754f6d4b744730626c7655785a4e336f6c764250554e49745274756a6130577436796732347a784c304b347777357179336b764e307143387543504338356d4a694b48784746676d2b6234326633662f2f454142635241414d4241414141414141414141414141414141414145524d41442f3267414941514942415438416d41736b612f2f454142515241514141414141414141414141414141414141414145442f3267414941514d4241543841542f2f5a00000000000000000000bc614e";

function convertImageFromDataUrl(dataUrl) {
  base64ImageToFile(dataUrl, process.cwd() + "/build/", function (err) {
    if (err) {
      return console.error(err);
    }
  });
}

function hex2a(data) {
  var hex = data.toString(); //force conversion
  var str = "";
  for (var i = 0; i < hex.length; i += 2)
    str += String.fromCharCode(parseInt(hex.substr(i, 2), 16));
  return str;
}

async function main() {
  const imageBytes = eventDataBytes.split("00bc614e");
  for(let i = 1; i < imageBytes.length - 1; i++){
    const dataString = hex2a(imageBytes[i]);
    convertImageFromDataUrl(dataString);
    console.log("image saved in build/");
  }
}

main()
